import{j as e,r as b,L as w,y as D}from"./app-BV5JBiLm.js";import{a as C}from"./axiosClient-B2D__FuD.js";import{P as F}from"./PageHeader-CkRZRRRX.js";import{R as f,C as P}from"./Card-CbhU03nD.js";import{C as l}from"./Col-P9ErBZdk.js";import{F as a,B as y}from"./Form-Ci1Ud1AT.js";import{P as L}from"./plus-BqzSZBSa.js";import{c as q,A as E}from"./AuthenticatedLayout-vhvuIAHI.js";import"./ThemeProvider-eU08k4HY.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],V=q("trash-2",A);function T({baseUnits:n,variants:g,onChange:j}){const _=(d,o,r)=>{const p=[...g];p[d][o]=r,j(p)},u=(d,o,r,p)=>{const m=[...g];m[d].bulk[o][r]=p,j(m)},i=()=>{const d=[...g,{base_unit_id:"",quantity:"",price:"",original_price:"",unit_rate:"",stock:"",is_bulk:!1,bulk:[{pieces_per_box:"",bulk_qty_range:"",bulk_price:"",total_box_price:"",margin:"",bulk_stock:"",best_value:!1}]}];j(d)},v=d=>{const o=[...g];o[d].bulk.push({pieces_per_box:"",bulk_qty_range:"",bulk_price:"",total_box_price:"",margin:"",bulk_stock:"",best_value:!1}),j(o)},N=(d,o)=>{const r=[...g];r[d].bulk.length>1&&(r[d].bulk.splice(o,1),j(r))};return e.jsxs(e.Fragment,{children:[g.map((d,o)=>e.jsxs("div",{className:"mb-4 p-3 border rounded bg-light",children:[e.jsxs(f,{children:[e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Select Base Unit"}),e.jsxs(a.Select,{value:d.base_unit_id,onChange:r=>_(o,"base_unit_id",r.target.value),children:[e.jsx("option",{value:"",children:"Choose..."}),n.map(r=>e.jsxs("option",{value:r.id,children:["  ",r.name,"(",r.base_unit,")"]},r.id))]})]})}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Weight or Pcs"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:d.quantity,onChange:r=>_(o,"quantity",r.target.value)})]})}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Price per Unit (â‚¹)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:d.price,onChange:r=>_(o,"price",r.target.value)})]})}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Original Price (â‚¹)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:d.original_price,onChange:r=>_(o,"original_price",r.target.value)})]})}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"KG Rate (â‚¹/L or â‚¹/KG)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",placeholder:"Auto: Price/weight Ã— 1000",value:d.unit_rate,onChange:r=>_(o,"unit_rate",r.target.value)})]})}),e.jsx(l,{md:2,children:e.jsx(a.Check,{label:"Available in Bulk",checked:d.is_bulk,onChange:r=>_(o,"is_bulk",r.target.checked)})})]}),d.is_bulk&&d.bulk.map((r,p)=>e.jsxs(f,{className:"pt-3",children:[e.jsx("h6",{className:"text-info mb-2 mt-3",children:"ðŸ§® Bulk Pricing"}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"No. of Pieces/Box"}),e.jsx(a.Control,{type:"text",value:r.pieces_per_box,onChange:m=>u(o,p,"pieces_per_box",m.target.value)})]})}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Bulk Qty Range"}),e.jsx(a.Control,{type:"text",value:r.bulk_qty_range,onChange:m=>u(o,p,"bulk_qty_range",m.target.value)})]})}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Bulk Price"}),e.jsx(a.Control,{type:"text",value:r.bulk_price,onChange:m=>u(o,p,"bulk_price",m.target.value)})]})}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Total Box Price"}),e.jsx(a.Control,{type:"text",value:r.total_box_price,onChange:m=>u(o,p,"total_box_price",m.target.value)})]})}),e.jsx(l,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Margin (%)"}),e.jsx(a.Control,{type:"text",value:r.margin,onChange:m=>u(o,p,"margin",m.target.value)})]})}),e.jsx(l,{md:1,className:"d-flex align-items-center",children:e.jsx(a.Check,{label:"Best Value",checked:r.best_value,onChange:m=>u(o,p,"best_value",m.target.checked)})}),e.jsxs(l,{md:1,className:"d-flex gap-1 mt-4",children:[e.jsx(y,{variant:"warning",className:"btn-sm",onClick:()=>v(o),children:e.jsx(L,{})}),e.jsx(y,{variant:"danger",className:"btn-sm",onClick:()=>N(o,p),disabled:d.bulk.length===1,children:e.jsx(V,{})})]})]},p))]},o)),e.jsx(f,{className:"mb-3",children:e.jsx(l,{md:2,children:e.jsxs(y,{variant:"info",className:"btn-sm waves-effect waves-light mb-3",onClick:i,children:[e.jsx(L,{})," Add More Variant"]})})})]})}function Q({product:n=null,categories:g,unitTypes:j,baseUnits:_}){const u=!!n,[i,v]=b.useState({}),[N,d]=b.useState([]),[o,r]=b.useState([]),[p,m]=b.useState([]),[t,x]=b.useState({name:"",category_id:"",sub_category_id:"",brand_id:"",disease_id:"",sku:"",unit_type_id:"",base_unit_id:"",images:[],hsn_code:"",sort_description:"",description:"",specification:"",other_information:"",is_active:!1,product_variant_price:[]});b.useEffect(()=>{(async()=>{if(u&&(n!=null&&n.category_id))try{const h=await C.get(`/admin/category/dependencies/${n.category_id}`);d(h.data.subcategories),r(h.data.brands),m(h.data.diseases)}catch(h){console.error("Error fetching dependencies:",h)}})()},[u,n==null?void 0:n.category_id]),b.useEffect(()=>{u&&n&&x({name:n.name,category_id:n.category_id||"",sub_category_id:n.sub_category_id||"",brand_id:n.brand_id||"",disease_id:n.disease_id||"",sku:n.sku,unit_type_id:n.unit_type_id||"",base_unit_id:n.base_unit_id||"",images:"",hsn_code:n.hsn_code,sort_description:n.sort_description,description:n.description,specification:n.specification,other_information:n.other_information,is_active:n.is_active??!1,product_variant_price:n.variants})},[n,u]);const S=async s=>{const h=s.target.value;x(c=>({...c,category_id:h,sub_category_id:"",brand_id:"",disease_id:""}));try{const c=await C.get(`/admin/category/dependencies/${h}`);d(c.data.subcategories),r(c.data.brands),m(c.data.diseases)}catch(c){console.error("Error loading dependencies:",c)}},G=async s=>{if(s.preventDefault(),!B())return;const h=new FormData;for(let c in t)if(c==="product_variant_price")h.append(c,JSON.stringify(t[c]));else if(c==="images"&&t[c])for(let k=0;k<t[c].length;k++)h.append("images[]",t[c][k]);else h.append(c,t[c]);console.log(t),console.log(t.product_variant_price);try{let c;u?(h.append("_method","PUT"),c=await C.post(`/admin/products/${n.id}`,h)):c=await C.post("/admin/products",h),D.success(c.data.message)}catch(c){c.response?(console.error("Error response:",c.response.data),v(c.response.data.errors||{})):console.error("Unexpected error:",c.message)}};function B(){let s={};return t.name||(s.name="Product name is required."),t.sku||(s.sku="Product sku is required."),t.description||(s.description="Product description is required."),t.category_id||(s.category_id="Product category is required."),t.sub_category_id||(s.sub_category_id="Product sub category is required."),!u&&(!t.images||t.images.length===0)&&(s.images="Product images are required."),(!t.product_variant_price||t.product_variant_price.length===0)&&(s.product_variant_price="Product variant & price are required."),v(s),Object.keys(s).length===0}return e.jsxs(E,{children:[e.jsx(F,{title:"Product Details"}),e.jsx(f,{children:e.jsxs(P,{children:[e.jsxs(P.Header,{children:["    ",u?"Update":"Add New"," Product "]}),e.jsx(P.Body,{children:e.jsxs(a,{onSubmit:G,encType:"multipart/form-data",children:[e.jsx("h6",{className:"text-info mb-3",children:" Basic Information "}),e.jsxs(f,{children:[e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product Name"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"text",name:"name",value:t.name||"",placeholder:"",autoComplete:"off",onChange:s=>x({...t,name:s.target.value})}),i.name&&e.jsx("div",{className:"text-danger",children:i.name})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Short Description"}),e.jsx(a.Control,{as:"textarea",name:"sort_description",value:t.sort_description||"",rows:3,onChange:s=>x({...t,sort_description:s.target.value}),children:" "}),i.sort_description&&e.jsx("div",{className:"text-danger",children:i.sort_description})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product SKU Id"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"text",name:"sku",value:t.sku||"",placeholder:"",autoComplete:"off",onChange:s=>x({...t,sku:s.target.value})}),i.sku&&e.jsx("div",{className:"text-danger",children:i.sku})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Category"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"category_id",value:t.category_id||"",onChange:S,children:[e.jsx("option",{value:"",children:"Choose..."}),g.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.category_id&&e.jsx("div",{className:"text-danger",children:i.category_id})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Sub Category"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"category_id",value:t.sub_category_id||"",onChange:s=>x({...t,sub_category_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.sub_category_id&&e.jsx("div",{className:"text-danger",children:i.sub_category_id})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Brand (Optinal)"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"brand_id",value:t.brand_id||"",onChange:s=>x({...t,brand_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),o.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.brand_id&&e.jsx("div",{className:"text-danger",children:i.brand_id})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Disease (Optinal)"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"disease_id",value:t.disease_id||"",onChange:s=>x({...t,disease_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),p.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.disease_id&&e.jsx("div",{className:"text-danger",children:i.disease_id})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Unit Type"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"unit_type_id",value:t.unit_type_id||"",onChange:s=>x({...t,unit_type_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.unit_type_id&&e.jsx("div",{className:"text-danger",children:i.unit_type_id})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Base Unit"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"base_unit_id",value:t.base_unit_id||"",onChange:s=>x({...t,base_unit_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),_.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.base_unit,")"]},s.id))]}),i.base_unit_id&&e.jsx("div",{className:"text-danger",children:i.base_unit_id})]})}),e.jsxs(l,{md:3,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product Image (Can select more then one)"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"file",name:"images[]",placeholder:"",autoComplete:"off",multiple:!0,onChange:s=>x({...t,images:s.target.files})})]}),e.jsx("div",{style:{display:"flex"},children:t.images&&Array.isArray(t.images)&&t.images.map((s,h)=>e.jsx("div",{className:"mb-2",children:e.jsx("img",{src:s.image_path,alt:"Product",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"5px"}})},h))}),i.images&&e.jsx("div",{className:"text-danger",children:i.images})]}),e.jsx(l,{md:3,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.hsn_code",children:[e.jsx(a.Label,{children:"HSN Code (optional)"}),e.jsx(a.Control,{type:"text",name:"hsn_code",placeholder:"",autoComplete:"off",value:t.hsn_code||"",onChange:s=>x({...t,hsn_code:s.target.value})}),i.hsn_code&&e.jsx("div",{className:"text-danger",children:i.hsn_code})]})})]}),e.jsx("hr",{}),e.jsxs(f,{children:[e.jsx("h6",{className:"text-info mb-2 mt-3",children:" Product Details"}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Product Specification"}),e.jsx(a.Control,{as:"textarea",name:"specification",value:t.specification||"",rows:3,onChange:s=>x({...t,specification:s.target.value}),children:" "}),i.specification&&e.jsx("div",{className:"text-danger",children:i.specification})]})}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Product Detailed  Description"}),e.jsx(a.Control,{as:"textarea",name:"description",value:t.description||"",rows:3,onChange:s=>x({...t,description:s.target.value}),children:" "}),i.description&&e.jsx("div",{className:"text-danger",children:i.description})]})}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Other Information"}),e.jsx(a.Control,{as:"textarea",name:"other_information",value:t.other_information||"",rows:3,onChange:s=>x({...t,other_information:s.target.value}),children:" "}),i.other_information&&e.jsx("div",{className:"text-danger",children:i.other_information})]})})]}),e.jsx("hr",{}),e.jsx("h6",{className:"text-info mb-2 mt-3",children:"ðŸ“¦ Product Variant & Pricing"}),i.product_variant_price&&e.jsx("div",{className:"text-danger mb-3",children:i.product_variant_price}),e.jsx(T,{variants:t.product_variant_price,baseUnits:_,onChange:s=>x({...t,product_variant_price:s})}),e.jsxs(y,{type:"submit",variant:"success",className:"btn-sm waves-effect waves-light mb-3",children:[u?"Update":"Save"," Product"]}),e.jsxs(w,{href:"/admin/products",children:[" ",e.jsx(y,{type:"button",variant:"danger",className:"btn btn-sm waves-effect waves-light  mb-3",children:" Back"})]})]})})]})})]})}export{Q as default};
