import{j as e,r as f,L as F,y as G}from"./app-D0IB18SU.js";import{a as S}from"./axiosClient-TjsMXgSu.js";import{P as A}from"./PageHeader-BI9g6Sui.js";import{R as v,C as n,F as a,B as y,a as L}from"./Card-D0MYNfrn.js";import{P as w}from"./plus-iGCqt9oy.js";import{c as V,A as q}from"./AuthenticatedLayout-DkhqQJWC.js";import"./ThemeProvider-CaR9PPcu.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],T=V("trash-2",E);function M({baseUnits:c,variants:g,onChange:b}){const j=(o,l,r)=>{const x=[...g];x[o][l]=r,b(x)},u=(o,l,r,x)=>{const h=[...g];h[o].bulk[l][r]=x,b(h)},i=()=>{const o=[...g,{base_unit_id:"",quantity:"",price:"",original_price:"",unit_rate:"",stock:"",is_bulk:!1,bulk:[{pieces_per_box:"",bulk_qty_range:"",bulk_price:"",total_box_price:"",margin:"",bulk_stock:"",best_value:!1}]}];b(o)},C=o=>{const l=[...g];l[o].bulk.push({pieces_per_box:"",bulk_qty_range:"",bulk_price:"",total_box_price:"",margin:"",bulk_stock:"",best_value:!1}),b(l)},N=(o,l)=>{const r=[...g];r[o].bulk.length>1&&(r[o].bulk.splice(l,1),b(r))};return e.jsxs(e.Fragment,{children:[g.map((o,l)=>e.jsxs("div",{className:"mb-4 p-3 border rounded bg-light",children:[e.jsxs(v,{children:[e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Select Base Unit"}),e.jsxs(a.Select,{value:o.base_unit_id,onChange:r=>j(l,"base_unit_id",r.target.value),children:[e.jsx("option",{value:"",children:"Choose..."}),c.map(r=>e.jsxs("option",{value:r.id,children:["  ",r.name,"(",r.base_unit,")"]},r.id))]})]})}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Weight or Pcs"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:o.quantity,onChange:r=>j(l,"quantity",r.target.value)})]})}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Price per Unit (â‚¹)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:o.price,onChange:r=>j(l,"price",r.target.value)})]})}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Original Price (â‚¹)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:o.original_price,onChange:r=>j(l,"original_price",r.target.value)})]})}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"KG Rate (â‚¹/L or â‚¹/KG)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",placeholder:"Auto: Price/weight Ã— 1000",value:o.unit_rate,onChange:r=>j(l,"unit_rate",r.target.value)})]})}),e.jsx(n,{md:2,children:e.jsx(a.Check,{label:"Available in Bulk",checked:o.is_bulk,onChange:r=>j(l,"is_bulk",r.target.checked)})})]}),o.is_bulk&&o.bulk.map((r,x)=>e.jsxs(v,{className:"pt-3",children:[e.jsx("h6",{className:"text-info mb-2 mt-3",children:"ðŸ§® Bulk Pricing"}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"No. of Pieces/Box"}),e.jsx(a.Control,{type:"text",value:r.pieces_per_box,onChange:h=>u(l,x,"pieces_per_box",h.target.value)})]})}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Bulk Qty Range"}),e.jsx(a.Control,{type:"text",value:r.bulk_qty_range,onChange:h=>u(l,x,"bulk_qty_range",h.target.value)})]})}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Bulk Price"}),e.jsx(a.Control,{type:"text",value:r.bulk_price,onChange:h=>u(l,x,"bulk_price",h.target.value)})]})}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Total Box Price"}),e.jsx(a.Control,{type:"text",value:r.total_box_price,onChange:h=>u(l,x,"total_box_price",h.target.value)})]})}),e.jsx(n,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Margin (%)"}),e.jsx(a.Control,{type:"text",value:r.margin,onChange:h=>u(l,x,"margin",h.target.value)})]})}),e.jsx(n,{md:1,className:"d-flex align-items-center",children:e.jsx(a.Check,{label:"Best Value",checked:r.best_value,onChange:h=>u(l,x,"best_value",h.target.checked)})}),e.jsxs(n,{md:1,className:"d-flex gap-1 mt-4",children:[e.jsx(y,{variant:"warning",className:"btn-sm",onClick:()=>C(l),children:e.jsx(w,{})}),e.jsx(y,{variant:"danger",className:"btn-sm",onClick:()=>N(l,x),disabled:o.bulk.length===1,children:e.jsx(T,{})})]})]},x))]},l)),e.jsx(v,{className:"mb-3",children:e.jsx(n,{md:2,children:e.jsxs(y,{variant:"info",className:"btn-sm waves-effect waves-light mb-3",onClick:i,children:[e.jsx(w,{})," Add More Variant"]})})})]})}function J({product:c=null,categories:g,unitTypes:b,baseUnits:j}){const u=!!c,[i,C]=f.useState({}),[N,o]=f.useState([]),[l,r]=f.useState([]),[x,h]=f.useState([]),[t,m]=f.useState({name:"",category_id:"",sub_category_id:"",brand_id:"",disease_id:"",sku:"",unit_type_id:"",base_unit_id:"",images:[],hsn_code:"",sort_description:"",description:"",specification:"",other_information:"",is_active:!1,product_variant_price:[]});f.useEffect(()=>{u&&c&&m({name:c.name,category_id:c.category_id,sub_category_id:c.sub_category_id,brand_id:c.brand_id,disease_id:c.disease_id,sku:c.sku,unit_type_id:c.unit_type_id,base_unit_id:c.base_unit_id,images:c.images,hsn_code:c.hsn_code,sort_description:c.sort_description,description:c.description,specification:c.specification,other_information:c.other_information,is_active:c.is_active??!1,product_variant_price:c.variants})},[c,u]);const B=async s=>{const p=s.target.value;m(_=>({..._,category_id:p,sub_category_id:"",brand_id:"",disease_id:""}));try{const _=await S.get(`/admin/category/dependencies/${p}`);o(_.data.subcategories),r(_.data.brands),h(_.data.diseases)}catch(_){console.error("Error loading dependencies:",_)}},D=async s=>{var _,P;s.preventDefault();const p=new FormData;for(let d in t)if(d==="product_variant_price")p.append(d,JSON.stringify(t[d]));else if(d==="images"&&t[d])for(let k=0;k<t[d].length;k++)p.append("images[]",t[d][k]);else p.append(d,t[d]);console.log(t.product_variant_price);try{let d;u?(p.append("_method","PUT"),d=await S.post(`/admin/products/${category.id}`,p)):d=await S.post("/admin/products",p),G.success(d.data.message),u||(m({name:"",image:null,description:"",is_active:""}),fileInputRef.current&&(fileInputRef.current.value=""))}catch(d){G.error(((P=(_=d.response)==null?void 0:_.data)==null?void 0:P.message)||"Something went wrong"),d.response?(console.error("Error response:",d.response.data),C(d.response.data.errors||{})):console.error("Unexpected error:",d.message)}};return e.jsxs(q,{children:[e.jsx(A,{title:"Product Details"}),e.jsx(v,{children:e.jsxs(L,{children:[e.jsxs(L.Header,{children:["    ",u?"Update":"Add New"," Product "]}),e.jsx(L.Body,{children:e.jsxs(a,{onSubmit:D,encType:"multipart/form-data",children:[e.jsx("h6",{className:"text-info mb-3",children:" Basic Information "}),e.jsxs(v,{children:[e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product Name"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"text",name:"name",value:t.name||"",placeholder:"",autoComplete:"off",onChange:s=>m({...t,name:s.target.value})}),i.name&&e.jsx("div",{className:"text-danger",children:i.name})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Short Description"}),e.jsx(a.Control,{as:"textarea",name:"sort_description",value:t.sort_description||"",rows:3,onChange:s=>m({...t,sort_description:s.target.value}),children:" "}),i.sort_description&&e.jsx("div",{className:"text-danger",children:i.sort_description})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product SKU Id"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"text",name:"sku",value:t.sku||"",placeholder:"",autoComplete:"off",onChange:s=>m({...t,sku:s.target.value})}),i.sku&&e.jsx("div",{className:"text-danger",children:i.sku})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Category"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"category_id",value:t.category_id||"",onChange:B,children:[e.jsx("option",{value:"",children:"Choose..."}),g.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.category_id&&e.jsx("div",{className:"text-danger",children:i.category_id})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Sub Category"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"category_id",value:t.sub_category_id||"",onChange:s=>m({...t,sub_category_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.sub_category_id&&e.jsx("div",{className:"text-danger",children:i.sub_category_id})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Brand (Optinal)"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"brand_id",value:t.brand_id||"",onChange:s=>m({...t,brand_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),l.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.brand_id&&e.jsx("div",{className:"text-danger",children:i.brand_id})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Disease (Optinal)"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"disease_id",value:t.disease_id||"",onChange:s=>m({...t,disease_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.disease_id&&e.jsx("div",{className:"text-danger",children:i.disease_id})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Unit Type"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"unit_type_id",value:t.unit_type_id||"",onChange:s=>m({...t,unit_type_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),b.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.unit_type_id&&e.jsx("div",{className:"text-danger",children:i.unit_type_id})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Base Unit"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"base_unit_id",value:t.base_unit_id||"",onChange:s=>m({...t,base_unit_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),j.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.base_unit,")"]},s.id))]}),i.base_unit_id&&e.jsx("div",{className:"text-danger",children:i.base_unit_id})]})}),e.jsxs(n,{md:3,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product Image (Can select more then one)"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"file",name:"images[]",placeholder:"",autoComplete:"off",multiple:!0,onChange:s=>m({...t,images:s.target.files})})]}),e.jsx("div",{style:{display:"flex"},children:t.images&&Array.isArray(t.images)&&t.images.map((s,p)=>e.jsx("div",{className:"mb-2",children:e.jsx("img",{src:`/storage/${s.image_path}`,alt:"Product",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"5px"}})},p))}),i.images&&e.jsx("div",{className:"text-danger",children:i.images})]}),e.jsx(n,{md:3,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.hsn_code",children:[e.jsx(a.Label,{children:"HSN Code (optional)"}),e.jsx(a.Control,{type:"text",name:"hsn_code",placeholder:"",autoComplete:"off",value:t.hsn_code||"",onChange:s=>m({...t,hsn_code:s.target.value})}),i.hsn_code&&e.jsx("div",{className:"text-danger",children:i.hsn_code})]})})]}),e.jsx("hr",{}),e.jsxs(v,{children:[e.jsx("h6",{className:"text-info mb-2 mt-3",children:" Product Details"}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Product Specification"}),e.jsx(a.Control,{as:"textarea",name:"specification",value:t.specification||"",rows:3,onChange:s=>m({...t,specification:s.target.value}),children:" "}),i.specification&&e.jsx("div",{className:"text-danger",children:i.specification})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Product Detailed  Description"}),e.jsx(a.Control,{as:"textarea",name:"description",value:t.description||"",rows:3,onChange:s=>m({...t,description:s.target.value}),children:" "}),i.description&&e.jsx("div",{className:"text-danger",children:i.description})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Other Information"}),e.jsx(a.Control,{as:"textarea",name:"other_information",value:t.other_information||"",rows:3,onChange:s=>m({...t,other_information:s.target.value}),children:" "}),i.other_information&&e.jsx("div",{className:"text-danger",children:i.other_information})]})})]}),e.jsx("hr",{}),e.jsx("h6",{className:"text-info mb-2 mt-3",children:"ðŸ“¦ Product Variant & Pricing"}),e.jsx(M,{variants:t.product_variant_price,baseUnits:j,onChange:s=>m({...t,product_variant_price:s})}),e.jsxs(y,{type:"submit",variant:"success",className:"btn-sm waves-effect waves-light mb-3",children:[u?"Update":"Save"," Product"]}),e.jsxs(F,{href:"/admin/home-banners",children:[" ",e.jsx(y,{type:"button",variant:"danger",className:"btn btn-sm waves-effect waves-light  mb-3",children:" Cancel"})]})]})})]})})]})}export{J as default};
