import{r as j,j as e,L as A,y as f}from"./app-CHY2S7fB.js";import{a as y}from"./axiosClient-CCDOYYJu.js";import{P}from"./PageHeader-BSMlnyHq.js";import{A as R}from"./AuthenticatedLayout-DLPlBDuW.js";import{R as D,C as h}from"./Card-BZedgk2Q.js";import{C}from"./Col-B7syMjbX.js";import{F as a,B as N}from"./Form-vqJ0bOdo.js";import{u as B,c as k}from"./ThemeProvider-CUgW6t52.js";import{B as E}from"./Badge-BEaglMbv.js";const $=j.forwardRef(({bsPrefix:b,className:c,striped:p,bordered:m,borderless:_,hover:t,size:o,variant:d,responsive:u,...v},g)=>{const n=B(b,"table"),w=k(c,n,d&&`${n}-${d}`,o&&`${n}-${o}`,p&&`${n}-${typeof p=="string"?`striped-${p}`:"striped"}`,m&&`${n}-bordered`,_&&`${n}-borderless`,t&&`${n}-hover`),r=e.jsx("table",{...v,className:w,ref:g});if(u){let i=`${n}-responsive`;return typeof u=="string"&&(i=`${i}-${u}`),e.jsx("div",{className:i,children:r})}return r});$.displayName="Table";function T({rewardSettings:b}){const[c,p]=j.useState(!1),[m,_]=j.useState(b),[t,o]=j.useState({min_order_amount:"",points_per_amount:"",redeem_value:"",is_active:!1}),[d,u]=j.useState({}),v=async r=>{var i,x;if(r.preventDefault(),!!w()){console.log(t);try{let s;c?s=await y.put(`/admin/discount/rewardsetting/${t.id}`,t):s=await y.post("/admin/discount/rewardsetting",t),f.success(s.data.message),c?_(m.map(l=>l.id===s.data.data.id?s.data.data:l)):(_([...m,s.data.data]),o({min_order_amount:"",points_per_amount:"",redeem_value:"",is_active:!1}))}catch(s){f.error(((x=(i=s.response)==null?void 0:i.data)==null?void 0:x.message)||"Something went wrong"),s.response?(console.error("Error response:",s.response.data),u(s.response.data.errors||{})):console.error("Unexpected error:",s.message)}}},g=r=>{p(!0),o({...t,id:r.id,min_order_amount:r.min_order_amount,points_per_amount:r.points_per_amount,redeem_value:r.redeem_value,is_active:r.is_active})},n=async r=>{var i,x,s;if(confirm("Are you sure, you want to delete this?"))try{const l=await y.delete(`/admin/discount/rewardsetting/${r}`);l.data.status===!0&&(_(m.filter(S=>S.id!==r)),f.success((i=l.data)==null?void 0:i.message))}catch(l){console.error("Delete error:",l),f.error(((s=(x=l.response)==null?void 0:x.data)==null?void 0:s.message)||"Something went wrong")}};function w(){let r={};return t.min_order_amount||(r.min_order_amount="Min order amount is required"),t.points_per_amount||(r.points_per_amount="Pont per amount is required"),t.redeem_value||(r.redeem_value="Redeem or point value is required"),u(r),Object.keys(r).length===0}return e.jsxs(R,{children:[e.jsx(P,{title:"Redeem settings",menu:"Offer & Discount"}),e.jsxs(D,{children:[e.jsx(C,{md:5,children:e.jsxs(h,{children:[e.jsxs(h.Header,{children:[" ",c?"Update":"Add New"," Redeem Point"]}),e.jsx(h.Body,{children:e.jsxs(a,{onSubmit:v,children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Min Order Amount"}),e.jsx(a.Control,{type:"number",value:t.min_order_amount,placeholder:"Minimum order value to earn points",onChange:r=>o({...t,min_order_amount:r.target.value})}),d.min_order_amount&&e.jsx("div",{className:"text-danger",children:d.min_order_amount})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Pont Per Amount"}),e.jsx(a.Control,{type:"number",value:t.points_per_amount,placeholder:"e.g. 1 point for every 100 spent",onChange:r=>o({...t,points_per_amount:r.target.value})}),d.points_per_amount&&e.jsx("div",{className:"text-danger",children:d.points_per_amount})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Redeem Value"}),e.jsx(a.Control,{type:"number",value:t.redeem_value,placeholder:"e.g. 1 point = 1 â‚¹",onChange:r=>o({...t,redeem_value:r.target.value})}),d.redeem_value&&e.jsx("div",{className:"text-danger",children:d.redeem_value})]}),e.jsx(a.Check,{className:"mb-5",type:"switch",id:"custom-switch",label:"Is Active",checked:t.is_active,onChange:r=>o({...t,is_active:r.target.checked})}),e.jsx(N,{type:"submit",variant:"success",className:"btn-sm waves-effect waves-light mb-3",children:c?"Update":"Create"}),e.jsxs(A,{href:"/admin/discount/rewardsetting",children:[" ",e.jsx(N,{type:"button",variant:"danger",className:"btn btn-sm waves-effect waves-light  mb-3",children:" Cancel "})]})]})})]})}),e.jsx(C,{md:7,children:e.jsxs(h,{children:[e.jsx(h.Header,{children:"Added Setting"}),e.jsx(h.Body,{children:e.jsxs($,{id:"datatable-buttons",className:"table table-bordered dt-responsive nowrap w-100",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Min Order"}),e.jsx("th",{children:"Pont Per Amount"}),e.jsx("th",{children:"Redeem Value"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:m.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(r.created_at).toLocaleDateString()}),e.jsx("td",{children:r.min_order_amount}),e.jsx("td",{children:r.points_per_amount}),e.jsx("td",{children:r.redeem_value}),e.jsxs("td",{children:[" ",e.jsx(E,{bg:r.is_active?"success":"secondary",children:r.is_active?"Active":"Disabled"})]}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-sm btn-primary me-1",onClick:()=>g(r),children:"Edit"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>n(r.id),children:"Delete"})]})]},r.id))})]})})]})})]})]})}export{T as default};
