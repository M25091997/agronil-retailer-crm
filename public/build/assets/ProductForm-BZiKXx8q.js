import{j as e,r as f,L as w,y as G,a as E}from"./app-DZz_DF51.js";import{a as N}from"./axiosClient-BoyTxGKA.js";import{P as M}from"./PageHeader-DnNU-AHW.js";import{R as y,C as S}from"./Card-DBxl2ISN.js";import{C as o}from"./Col-iDnZJjnq.js";import{F as a,B as v}from"./Form-CGhhW8NK.js";import{P as B}from"./plus-DLUPRUL4.js";import{c as D,A}from"./AuthenticatedLayout-BvoWsP3O.js";import"./ThemeProvider-DUMPLo0h.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],H=D("save",T);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],$=D("trash-2",O);function z({baseUnits:l,variants:j,onChange:b}){const g=(n,c,i)=>{const u=[...j];u[n][c]=i,b(u)},x=(n,c,i,u)=>{const _=[...j];_[n].bulk[c][i]=u,b(_)},t=()=>{const n=[...j,{base_unit_id:"",quantity:"",price:"",original_price:"",unit_rate:"",stock:"",is_bulk:!1,bulk:[{pieces_per_box:"",bulk_qty_range:"",bulk_price:"",total_box_price:"",margin:"",bulk_stock:"",best_value:!1}]}];b(n)},C=n=>{const c=[...j];c[n].bulk.push({pieces_per_box:"",bulk_qty_range:"",bulk_price:"",total_box_price:"",margin:"",bulk_stock:"",best_value:!1}),b(c)},k=(n,c)=>{const i=[...j];i[n].bulk.length>1&&(i[n].bulk.splice(c,1),b(i))};return e.jsxs(e.Fragment,{children:[j.map((n,c)=>e.jsxs("div",{className:"mb-4 p-3 border rounded bg-light",children:[e.jsxs(y,{children:[e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Select Base Unit"}),e.jsxs(a.Select,{value:n.base_unit_id,onChange:i=>g(c,"base_unit_id",i.target.value),children:[e.jsx("option",{value:"",children:"Choose..."}),l.map(i=>e.jsxs("option",{value:i.id,children:["  ",i.name,"(",i.base_unit,")"]},i.id))]})]})}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Weight or Pcs"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:n.quantity,onChange:i=>g(c,"quantity",i.target.value)})]})}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Selling Unit (â‚¹)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:n.price,onChange:i=>g(c,"price",i.target.value)})]})}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Original Price (â‚¹)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",value:n.original_price,onChange:i=>g(c,"original_price",i.target.value)})]})}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"KG Rate (â‚¹/L or â‚¹/KG)"}),e.jsx(a.Control,{type:"text",autoComplete:"off",placeholder:"",value:n.unit_rate,onChange:i=>g(c,"unit_rate",i.target.value)})]})}),e.jsx(o,{md:2,children:e.jsx(a.Check,{label:"Available in Bulk",checked:n.is_bulk,onChange:i=>g(c,"is_bulk",i.target.checked)})})]}),n.is_bulk&&n.bulk.map((i,u)=>e.jsxs(y,{className:"pt-3",children:[e.jsx("h6",{className:"text-info mb-2 mt-3",children:"ðŸ§® Bulk Pricing"}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"No. of Pieces/Box"}),e.jsx(a.Control,{type:"text",value:i.pieces_per_box,onChange:_=>x(c,u,"pieces_per_box",_.target.value)})]})}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Bulk Qty Range"}),e.jsx(a.Control,{type:"text",value:i.bulk_qty_range,onChange:_=>x(c,u,"bulk_qty_range",_.target.value)})]})}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Bulk Price"}),e.jsx(a.Control,{type:"text",value:i.bulk_price,onChange:_=>x(c,u,"bulk_price",_.target.value)})]})}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Total Box Price"}),e.jsx(a.Control,{type:"text",value:i.pieces_per_box*n.price,onChange:_=>x(c,u,"total_box_price",i.pieces_per_box*n.price)})]})}),e.jsx(o,{md:2,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Margin (%)"}),e.jsx(a.Control,{type:"text",value:(i.pieces_per_box*n.price-i.bulk_price)*100/(i.pieces_per_box*n.price),onChange:_=>x(c,u,"margin",(i.pieces_per_box*n.price-i.bulk_price)*100/i.pieces_per_box*n.price)})]})}),e.jsx(o,{md:1,className:"d-flex align-items-center",children:e.jsx(a.Check,{label:"Best Value",checked:i.best_value,onChange:_=>x(c,u,"best_value",_.target.checked)})}),e.jsxs(o,{md:1,className:"d-flex gap-1 mt-4",children:[e.jsx(v,{variant:"warning",className:"btn-sm",onClick:()=>C(c),children:e.jsx(B,{})}),e.jsx(v,{variant:"danger",className:"btn-sm",onClick:()=>k(c,u),disabled:n.bulk.length===1,children:e.jsx($,{})})]})]},u))]},c)),e.jsx(y,{className:"mb-3",children:e.jsx(o,{children:e.jsxs(v,{variant:"info",className:"btn-sm btn-info mb-3 float-end",onClick:t,children:[e.jsx(B,{size:16})," Add More Variant"]})})})]})}function R({product:l=null,categories:j,unitTypes:b,baseUnits:g}){const x=!!l,[t,C]=f.useState({}),[k,n]=f.useState([]),[c,i]=f.useState([]),[u,_]=f.useState([]),[r,h]=f.useState({name:"",category_id:"",sub_category_id:"",brand_id:"",disease_id:"",sku:"",unit_type_id:"",base_unit_id:"",images:[],hsn_code:"",sort_description:"",description:"",specification:"",other_information:"",is_active:!1,product_variant_price:[]});f.useEffect(()=>{(async()=>{if(x&&(l!=null&&l.category_id))try{const m=await N.get(`/admin/category/dependencies/${l.category_id}`);n(m.data.subcategories),i(m.data.brands),_(m.data.diseases)}catch(m){console.error("Error fetching dependencies:",m)}})()},[x,l==null?void 0:l.category_id]),f.useEffect(()=>{x&&l&&h({name:l.name,category_id:l.category_id||"",sub_category_id:l.sub_category_id||"",brand_id:l.brand_id||"",disease_id:l.disease_id||"",sku:l.sku,unit_type_id:l.unit_type_id||"",base_unit_id:l.base_unit_id||"",images:"",hsn_code:l.hsn_code,sort_description:l.sort_description,description:l.description,specification:l.specification,other_information:l.other_information,is_active:l.is_active??!1,product_variant_price:l.variants})},[l,x]);const q=async s=>{const m=s.target.value;h(p=>({...p,category_id:m,sub_category_id:"",brand_id:"",disease_id:""}));try{const p=await N.get(`/admin/category/dependencies/${m}`);n(p.data.subcategories),i(p.data.brands),_(p.data.diseases)}catch(p){console.error("Error loading dependencies:",p)}},F=async s=>{var p,L;if(s.preventDefault(),!V())return;const m=new FormData;for(let d in r)if(d==="product_variant_price")m.append(d,JSON.stringify(r[d]));else if(d==="images"&&r[d])for(let P=0;P<r[d].length;P++)m.append("images[]",r[d][P]);else m.append(d,r[d]);console.log(r),console.log(r.product_variant_price);try{let d;x?(m.append("_method","PUT"),d=await N.post(`/admin/products/${l.id}`,m)):d=await N.post("/admin/products",m),G.success(d.data.message),E.visit("/admin/products")}catch(d){G.error(((L=(p=d.response)==null?void 0:p.data)==null?void 0:L.message)||"Something went wrong"),d.response?(console.error("Error response:",d.response.data),C(d.response.data.errors||{})):console.error("Unexpected error:",d.message)}};function V(){let s={};return r.name||(s.name="Product name is required."),r.sku||(s.sku="Product sku is required."),r.description||(s.description="Product description is required."),r.category_id||(s.category_id="Product category is required."),r.sub_category_id||(s.sub_category_id="Product sub category is required."),!x&&(!r.images||r.images.length===0)&&(s.images="Product images are required."),(!r.product_variant_price||r.product_variant_price.length===0)&&(s.product_variant_price="Product variant & price are required."),r.product_variant_price.length>0&&r.product_variant_price.filter(p=>!p.price||!p.original_price||!p.base_unit_id||!p.quantity||!p.unit_rate).length>0&&(s.product_variant_price="Please fill all required fields in product variants!"),C(s),Object.keys(s).length===0}return e.jsxs(A,{children:[e.jsx(M,{title:"Product Details"}),e.jsx(y,{children:e.jsxs(S,{children:[e.jsxs(S.Header,{children:["    ",x?"Update":"Add New"," Product "]}),e.jsx(S.Body,{children:e.jsxs(a,{onSubmit:F,encType:"multipart/form-data",children:[e.jsx("h6",{className:"text-info mb-3",children:" Basic Information "}),e.jsxs(y,{children:[e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product Name"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"text",name:"name",value:r.name||"",placeholder:"",autoComplete:"off",onChange:s=>h({...r,name:s.target.value})}),t.name&&e.jsx("div",{className:"text-danger",children:t.name})]})}),e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Short Description"}),e.jsx(a.Control,{as:"textarea",name:"sort_description",value:r.sort_description||"",rows:3,onChange:s=>h({...r,sort_description:s.target.value}),children:" "}),t.sort_description&&e.jsx("div",{className:"text-danger",children:t.sort_description})]})}),e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product SKU Id"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"text",name:"sku",value:r.sku||"",placeholder:"",autoComplete:"off",onChange:s=>h({...r,sku:s.target.value})}),t.sku&&e.jsx("div",{className:"text-danger",children:t.sku})]})}),e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Category"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"category_id",value:r.category_id||"",onChange:q,children:[e.jsx("option",{value:"",children:"Choose..."}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),t.category_id&&e.jsx("div",{className:"text-danger",children:t.category_id})]})}),e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Sub Category"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"category_id",value:r.sub_category_id||"",onChange:s=>h({...r,sub_category_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),k.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),t.sub_category_id&&e.jsx("div",{className:"text-danger",children:t.sub_category_id})]})}),e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Brand (Optinal)"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"brand_id",value:r.brand_id||"",onChange:s=>h({...r,brand_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),c.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),t.brand_id&&e.jsx("div",{className:"text-danger",children:t.brand_id})]})}),e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Disease (Optinal)"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"disease_id",value:r.disease_id||"",onChange:s=>h({...r,disease_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),u.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),t.disease_id&&e.jsx("div",{className:"text-danger",children:t.disease_id})]})}),e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Unit Type"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"unit_type_id",value:r.unit_type_id||"",onChange:s=>h({...r,unit_type_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),b.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),t.unit_type_id&&e.jsx("div",{className:"text-danger",children:t.unit_type_id})]})}),e.jsx(o,{md:4,children:e.jsxs(a.Group,{className:"mb-3",controlId:"category_id",children:[e.jsx(a.Label,{children:"Select Base Unit"}),e.jsxs(a.Select,{"aria-label":"Default select example",name:"base_unit_id",value:r.base_unit_id||"",onChange:s=>h({...r,base_unit_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Choose..."}),g.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.base_unit,")"]},s.id))]}),t.base_unit_id&&e.jsx("div",{className:"text-danger",children:t.base_unit_id})]})}),e.jsxs(o,{md:3,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Product Image (Can select more then one)"})," ",e.jsx("span",{className:"text-danger",children:"*"}),e.jsx(a.Control,{type:"file",name:"images[]",placeholder:"",autoComplete:"off",multiple:!0,onChange:s=>h({...r,images:s.target.files})})]}),e.jsx("div",{style:{display:"flex"},children:r.images&&Array.isArray(r.images)&&r.images.map((s,m)=>e.jsx("div",{className:"mb-2",children:e.jsx("img",{src:s.image_path,alt:"Product",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"5px"}})},m))}),t.images&&e.jsx("div",{className:"text-danger",children:t.images})]}),e.jsx(o,{md:3,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.hsn_code",children:[e.jsx(a.Label,{children:"HSN Code (optional)"}),e.jsx(a.Control,{type:"text",name:"hsn_code",placeholder:"",autoComplete:"off",value:r.hsn_code||"",onChange:s=>h({...r,hsn_code:s.target.value})}),t.hsn_code&&e.jsx("div",{className:"text-danger",children:t.hsn_code})]})})]}),e.jsx("hr",{}),e.jsxs(y,{children:[e.jsx("h6",{className:"text-info mb-2 mt-3",children:" Product Details"}),e.jsx(o,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Product Specification"}),e.jsx(a.Control,{as:"textarea",name:"specification",value:r.specification||"",rows:3,onChange:s=>h({...r,specification:s.target.value}),children:" "}),t.specification&&e.jsx("div",{className:"text-danger",children:t.specification})]})}),e.jsx(o,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Product Detailed  Description"}),e.jsx(a.Control,{as:"textarea",name:"description",value:r.description||"",rows:3,onChange:s=>h({...r,description:s.target.value}),children:" "}),t.description&&e.jsx("div",{className:"text-danger",children:t.description})]})}),e.jsx(o,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:"Other Information"}),e.jsx(a.Control,{as:"textarea",name:"other_information",value:r.other_information||"",rows:3,onChange:s=>h({...r,other_information:s.target.value}),children:" "}),t.other_information&&e.jsx("div",{className:"text-danger",children:t.other_information})]})})]}),e.jsx("hr",{}),e.jsx("h6",{className:"text-info mb-2 mt-3",children:"ðŸ“¦ Product Variant & Pricing"}),t.product_variant_price&&e.jsx("div",{className:"text-danger mb-3",children:t.product_variant_price}),e.jsx(z,{variants:r.product_variant_price,baseUnits:g,onChange:s=>h({...r,product_variant_price:s})}),e.jsxs(v,{type:"submit",variant:"success",className:"btn-sm waves-effect waves-light mb-3",children:[e.jsx(H,{size:18})," ",x?"Update":"Save","   Product"]}),e.jsxs(w,{href:"/admin/products",children:[" ",e.jsx(v,{type:"button",variant:"danger",className:"btn btn-sm waves-effect waves-light  mb-3",children:"  Back"})]})]})})]})})]})}export{R as default};
